function r = fft8(x)
global aa;
global mm;


z = x;

z(1) = x(1) + x(5);
z(2) = x(2) + x(6);
z(3) = x(3) + x(7);
z(4) = x(4) + x(8);

z(5) = x(1) - x(5);
z(6) = (x(2) - x(6)) * exp(-1i * 2 * pi * 1 / 8);
z(7) = (x(3) - x(7)) * exp(-1i * 2 * pi * 2 / 8);
z(8) = (x(4) - x(8)) * exp(-1i * 2 * pi * 3 / 8);

f = z;

f(1) = z(1) + z(3);
f(3) = z(1) - z(3);
f(2) = z(2) + z(4);
f(4) = (z(2) - z(4)) * exp(-1i * 2 * pi * 1 / 4);

f(5) = z(5) + z(7);
f(7) = z(5) - z(7);
f(6) = z(6) + z(8);
f(8) = (z(6) - z(8)) * exp(-1i * 2 * pi * 1 / 4);

t = f;

t(1) = f(1) + f(2);
t(2) = f(1) - f(2);

t(3) = f(3) + f(4);
t(4) = f(3) - f(4);

t(5) = f(5) + f(6);
t(6) = f(5) - f(6);

t(7) = f(7) + f(8);
t(8) = f(7) - f(8);

o = t;

o(1) = t(1);
o(2) = t(5);
o(3) = t(3);
o(4) = t(7);
o(5) = t(2);
o(6) = t(6);
o(7) = t(4);
o(8) = t(8);

r = o;

aa = 8 * 3 + aa;
mm = 4 * 3 + mm;














